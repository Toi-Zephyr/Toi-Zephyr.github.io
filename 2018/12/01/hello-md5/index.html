<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Zephyr"><title>MD5 ç®—æ³•çš„è®¾è®¡ä¸å®ç° Â· è¿·æ¥¼</title><meta name="description" content="å®ç°ä¸€ä¸ª MD5 ç®—æ³•ç®—æ³•åŸç†æ¦‚è¿°ä»€ä¹ˆæ˜¯ MD5 ï¼ŸMD5 ç®—æ³•æ˜¯ä¸€ç§æ¶ˆæ¯æ‘˜è¦ç®—æ³•ã€‚ç‰¹ç‚¹ï¼š

å®šé•¿æ€§ã€‚è¾“å…¥ä»»æ„é•¿åº¦çš„ä¿¡æ¯ï¼Œç»è¿‡å¤„ç†ï¼Œè¾“å‡ºä¸º128ä½çš„ä¿¡æ¯ã€‚
å”¯ä¸€æ€§ã€‚ä¸åŒçš„è¾“å…¥å¾—åˆ°çš„ä¸åŒçš„ç»“æœã€‚
ä¸å¯é€†ã€‚æ ¹æ®128ä½çš„è¾“å‡ºç»“æœä¸å¯èƒ½åæ¨å‡ºè¾“å…¥çš„ä¿¡æ¯ã€‚

å®ç°åŸç†MD5 ç®—æ³•å¯ä»¥ç®€å•æ¦‚æ‹¬æˆ4æ­¥ã€‚

ä¿¡æ¯"><meta name="keywords" content="blog"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">å¾Œã¯é‡ã¨ãªã‚Œå±±ã¨ãªã‚Œ</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">è¦‹ã¬ãŒèŠ±</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">é¦–é </a></li><li><a href="/archives">æ­¸æª”</a></li><li><a href="/categories">åˆ†é¡</a></li><li><a href="/tags">æ¨™ç±¤</a></li><li><a href="/404.html">404</a></li><li><a href="/about/index.html">é—œæ–¼</a></li><li class="soc"><a href="https://github.com/Zophyr" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2019&nbsp;<a target="_blank" href="http://zophyr.com" rel="noopener noreferrer">Zephyr</a></p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>MD5 ç®—æ³•çš„è®¾è®¡ä¸å®ç°</a></p><p class="post-meta"><span class="date meta-item">ç™¼ä½ˆæ–¼&nbsp;2018-12-01</span><span class="meta-item"><i class="fa fa-folder"></i><span>&nbsp;</span><a href="/categories/æ•™ç¨‹/" title="æ•™ç¨‹" class="a-tag">æ•™ç¨‹</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/æ•™ç¨‹/" title="æ•™ç¨‹" class="a-tag">æ•™ç¨‹</a><span> / </span><a href="/tags/hello-world/" title="hello-world" class="a-tag">hello-world</a><span> / </span><a href="/tags/ç®—æ³•/" title="ç®—æ³•" class="a-tag">ç®—æ³•</a><span> / </span><a href="/tags/MD5/" title="MD5" class="a-tag">MD5</a><span> / </span><a href="/tags/åŠ å¯†/" title="åŠ å¯†" class="a-tag">åŠ å¯†</a><span> / </span></span></p><p class="post-abstract"></p><h1 id="å®ç°ä¸€ä¸ª-MD5-ç®—æ³•"><a href="#å®ç°ä¸€ä¸ª-MD5-ç®—æ³•" class="headerlink" title="å®ç°ä¸€ä¸ª MD5 ç®—æ³•"></a>å®ç°ä¸€ä¸ª MD5 ç®—æ³•</h1><h2 id="ç®—æ³•åŸç†æ¦‚è¿°"><a href="#ç®—æ³•åŸç†æ¦‚è¿°" class="headerlink" title="ç®—æ³•åŸç†æ¦‚è¿°"></a>ç®—æ³•åŸç†æ¦‚è¿°</h2><h3 id="ä»€ä¹ˆæ˜¯-MD5-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-MD5-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ MD5 ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ MD5 ï¼Ÿ</h3><p>MD5 ç®—æ³•æ˜¯ä¸€ç§æ¶ˆæ¯æ‘˜è¦ç®—æ³•ã€‚<br>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>å®šé•¿æ€§ã€‚è¾“å…¥ä»»æ„é•¿åº¦çš„ä¿¡æ¯ï¼Œç»è¿‡å¤„ç†ï¼Œè¾“å‡ºä¸º128ä½çš„ä¿¡æ¯ã€‚</li>
<li>å”¯ä¸€æ€§ã€‚ä¸åŒçš„è¾“å…¥å¾—åˆ°çš„ä¸åŒçš„ç»“æœã€‚</li>
<li>ä¸å¯é€†ã€‚æ ¹æ®128ä½çš„è¾“å‡ºç»“æœä¸å¯èƒ½åæ¨å‡ºè¾“å…¥çš„ä¿¡æ¯ã€‚</li>
</ol>
<h3 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h3><p><strong>MD5 ç®—æ³•å¯ä»¥ç®€å•æ¦‚æ‹¬æˆ4æ­¥ã€‚</strong></p>
<ol>
<li><strong>ä¿¡æ¯å¡«å……ã€‚</strong>MD5 å¯¹äºå¤„ç†ä¿¡æ¯çš„å­—èŠ‚é•¿åº¦æœ‰è¦æ±‚â€”â€”è¾“å…¥ä¿¡æ¯çš„é•¿åº¦(bit)å¯¹512æ±‚ä½™çš„ç»“æœç­‰äº448â€”â€”æ‰€ä»¥æˆ‘ä»¬è¦å…ˆå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä½¿å…¶é•¿åº¦ç¬¦åˆç®—æ³•è¦æ±‚ã€‚</li>
<li><strong>è®°å½•ä¿¡æ¯é•¿åº¦ã€‚</strong>MD5 ä¸­ä¼šç”¨64ä½æ¥å­˜å‚¨ä¿¡æ¯é•¿åº¦ã€‚è¿™æ ·åŠ ä¸Šç¬¬ä¸€æ­¥ä¸­çš„é•¿åº¦ã€‚æ€»çš„æ•°æ®é•¿åº¦å°±ä¸º <code>N x 512</code> ä¸º512çš„å€æ•°ã€‚</li>
<li><strong>å››è½®å¾ªç¯è¿ç®—ã€‚</strong>è¿™æ˜¯ MD5 ç®—æ³•çš„æ ¸å¿ƒã€‚æˆ‘ä»¬ç›´æ¥æ ¹æ®ç®—æ³•å®šä¹‰å®ç°å°±å¥½ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºæˆ‘ä»¬è¿›è¡Œäº†ä¸€ç³»åˆ—çš„éçº¿æ€§å‡½æ•°è¿ç®—ï¼Œè®¡ç®—å‡ºäº†MD5ä¸­å››ä¸ª32ä½çš„ç§°ä½œé“¾æ¥å˜é‡ï¼ˆChaining Variableï¼‰çš„æ•´æ•°å‚æ•°çš„æ–°çš„å€¼ã€‚</li>
<li><strong>åˆå¹¶é“¾æ¥å˜é‡ã€‚</strong>æˆ‘ä»¬è®¡ç®—å‡ºæ–°çš„å››ä¸ªé“¾æ¥å˜é‡å€¼åï¼Œæˆ‘ä»¬æŒ‰ç…§é€†åºï¼Œå°†ä»–ä»¬è½¬åŒ–æˆ16è¿›åˆ¶çš„æ•°ç„¶åå››ä¸ªåˆåœ¨ä¸€èµ·ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å°†å¾—åˆ°çš„ç»“æœè¾“å‡ºã€‚</li>
</ol>
<h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><h3 id="æ•°æ®å®šä¹‰"><a href="#æ•°æ®å®šä¹‰" class="headerlink" title="æ•°æ®å®šä¹‰"></a>æ•°æ®å®šä¹‰</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * byte å­—èŠ‚</span></span><br><span class="line"><span class="comment"> * ä¸€ä¸ªå­—ç¬¦(char) å³ ä¸€ä¸ªå­—èŠ‚(byte) 8ä½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> byte;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * bit æ¯”ç‰¹</span></span><br><span class="line"><span class="comment"> * æ— ç¬¦å·æ•´æ•° å³ 32ä½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> bit32;</span><br></pre></td></tr></table></figure>
<h3 id="å…¬æœ‰å‡½æ•°"><a href="#å…¬æœ‰å‡½æ•°" class="headerlink" title="å…¬æœ‰å‡½æ•°"></a>å…¬æœ‰å‡½æ•°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * æ„é€ å‡½æ•°ï¼Œç”¨äºåˆå§‹åŒ– MD5 ç®—æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">MD5(<span class="keyword">const</span> <span class="built_in">string</span> &amp;message);</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * è·å¾—ç»è¿‡ MD5 ç®—æ³•ä¹‹åçš„ç»“æœã€‚</span></span><br><span class="line"><span class="comment"> * åœ¨æ­¤å¤„å®Œæˆåˆå¹¶é“¾æ¥å˜é‡ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">getResult</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="ç§æœ‰å‡½æ•°"><a href="#ç§æœ‰å‡½æ•°" class="headerlink" title="ç§æœ‰å‡½æ•°"></a>ç§æœ‰å‡½æ•°</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * åˆå§‹åŒ–å‡½æ•°</span></span><br><span class="line"><span class="comment"> * è¿›è¡Œ Step 1.ä¿¡æ¯å¡«å……</span></span><br><span class="line"><span class="comment"> * åŒæ—¶ä¹Ÿä¼šè¿›è¡Œ Step 2.è®°å½•ä¿¡æ¯é•¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> _init(<span class="keyword">const</span> <span class="built_in">string</span> input);</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * å¾ªç¯åˆ†ç»„å‡½æ•°</span></span><br><span class="line"><span class="comment"> * ä¸ºæ­¥éª¤3åšå‡†å¤‡</span></span><br><span class="line"><span class="comment"> * å°†æ¯ä¸€512å­—èŠ‚ç»†åˆ†æˆ16ä¸ªå°ç»„ï¼Œæ¯ä¸ªå°ç»„64ä½ä»¥æ­¤æ¥è¿›è¡Œå¾ªç¯è¿ç®—ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> _loop();</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * MD5 ä¸»å˜æ¢å¾ªç¯</span></span><br><span class="line"><span class="comment"> * è¿›è¡Œ Step 3.å››è½®å¾ªç¯è¿ç®—</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> _transform(<span class="keyword">const</span> bit32 block[]);</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * è½¬åŒ–å‡½æ•°</span></span><br><span class="line"><span class="comment"> * æŒ‰ç…§é€†åºï¼Œå°†å¾—åˆ°çš„å››ä¸ªé“¾æ¥å˜é‡è½¬åŒ–æˆ16è¿›åˆ¶</span></span><br><span class="line"><span class="comment"> * è¿›è¡Œ Step 4.åˆå¹¶é“¾æ¥å˜é‡çš„å‰ä¸€æ­¥ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">string</span> _toHex(<span class="keyword">const</span> bit32 number);</span><br></pre></td></tr></table></figure>
<h3 id="ç§æœ‰å˜é‡"><a href="#ç§æœ‰å˜é‡" class="headerlink" title="ç§æœ‰å˜é‡"></a>ç§æœ‰å˜é‡</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * MD5 å››ä¸ªæ ‡å‡†å¹»æ•° A, B, C, D</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">bit32 _state[<span class="number">4</span>];</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * å¤„ç†ä¹‹åæ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">bit32 *_strByte;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * æ•°æ®é•¿åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">bit32 _strLength;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * ç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="built_in">string</span> _result;</span><br></pre></td></tr></table></figure>
<h2 id="ç®—æ³•å®ç°"><a href="#ç®—æ³•å®ç°" class="headerlink" title="ç®—æ³•å®ç°"></a>ç®—æ³•å®ç°</h2><h3 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h3><h4 id="å®šä¹‰æ ‡å‡†å¹»æ•°"><a href="#å®šä¹‰æ ‡å‡†å¹»æ•°" class="headerlink" title="å®šä¹‰æ ‡å‡†å¹»æ•°"></a>å®šä¹‰æ ‡å‡†å¹»æ•°</h4><p>æ ‡å‡†çš„å¹»æ•°ï¼ˆç‰©ç†é¡ºåºï¼‰æ˜¯</p>
<ul>
<li>A=(01234567)16 </li>
<li>B=(89ABCDEF)16 </li>
<li>C=(FEDCBA98)16 </li>
<li>D=(76543210)16 </li>
</ul>
<p>å¦‚æœåœ¨ç¨‹åºä¸­å®šä¹‰åº”è¯¥æ˜¯</p>
<ul>
<li>A=0X67452301</li>
<li>B=0XEFCDAB89</li>
<li>C=0X98BADCFE</li>
<li>D=0X10325476</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MD5 å››ä¸ªæ ‡å‡†å¹»æ•° A, B, C, D</span></span><br><span class="line"><span class="comment"> * ç”±ç®—æ³•å®šä¹‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A 0x67452301</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B 0xefcdab89</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> C 0x98badcfe</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> D 0x10325476</span></span><br></pre></td></tr></table></figure>
<h4 id="å®šä¹‰å˜æ¢è¾…åŠ©å‡½æ•°"><a href="#å®šä¹‰å˜æ¢è¾…åŠ©å‡½æ•°" class="headerlink" title="å®šä¹‰å˜æ¢è¾…åŠ©å‡½æ•°"></a>å®šä¹‰å˜æ¢è¾…åŠ©å‡½æ•°</h4><p>ä»¥ä¸‹æ˜¯æ¯æ¬¡æ“ä½œä¸­ç”¨åˆ°çš„å››ä¸ªéçº¿æ€§å‡½æ•°ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰ MD5 å˜æ¢è¾…åŠ©å‡½æ•°</span></span><br><span class="line"><span class="comment"> * ç”± MD5 ç®—æ³•æœ¬èº«å®šä¹‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> F(x, y, z) (((x) &amp; (y)) | ((~x) &amp; (z)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> G(x, y, z) (((x) &amp; (z)) | ((y) &amp; (~z)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> H(x, y, z) ((x) ^ (y) ^ (z))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> I(x, y, z) ((y) ^ ((x) | (~z)))</span></span><br></pre></td></tr></table></figure>
<h4 id="å®šä¹‰å››ç§åŸºæœ¬å˜æ¢"><a href="#å®šä¹‰å››ç§åŸºæœ¬å˜æ¢" class="headerlink" title="å®šä¹‰å››ç§åŸºæœ¬å˜æ¢"></a>å®šä¹‰å››ç§åŸºæœ¬å˜æ¢</h4><p>ä»¥ä¸‹æ˜¯ MD5 ç®—æ³•ä¸­çš„å››ç§åŸºæœ¬å˜æ¢</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MD5 å››ç§åŸºæœ¬å˜æ¢</span></span><br><span class="line"><span class="comment"> * ç”± MD5 ç®—æ³•æœ¬èº«å®šä¹‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FF(a, b, c, d, x, s, ac) &#123; \</span></span><br><span class="line">    (a) += F ((b), (c), (d)) + (x) + ac; \</span><br><span class="line">    (a) = ROTATELEFT ((a), (s)); \</span><br><span class="line">    (a) += (b); \</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GG(a, b, c, d, x, s, ac) &#123; \</span></span><br><span class="line">    (a) += G ((b), (c), (d)) + (x) + ac; \</span><br><span class="line">    (a) = ROTATELEFT ((a), (s)); \</span><br><span class="line">    (a) += (b); \</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HH(a, b, c, d, x, s, ac) &#123; \</span></span><br><span class="line">    (a) += H ((b), (c), (d)) + (x) + ac; \</span><br><span class="line">    (a) = ROTATELEFT ((a), (s)); \</span><br><span class="line">    (a) += (b); \</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> II(a, b, c, d, x, s, ac) &#123; \</span></span><br><span class="line">    (a) += I ((b), (c), (d)) + (x) + ac; \</span><br><span class="line">    (a) = ROTATELEFT ((a), (s)); \</span><br><span class="line">    (a) += (b); \</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">MD5::MD5(<span class="keyword">const</span> <span class="built_in">string</span> &amp;message) &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ ‡å‡†å¹»æ•°</span></span><br><span class="line">    _state[<span class="number">0</span>] = A;</span><br><span class="line">    _state[<span class="number">1</span>] = B;</span><br><span class="line">    _state[<span class="number">2</span>] = C;</span><br><span class="line">    _state[<span class="number">3</span>] = D;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç§æœ‰å˜é‡</span></span><br><span class="line">    _result = <span class="string">""</span>;</span><br><span class="line">    _strByte = <span class="literal">NULL</span>;</span><br><span class="line">    _strLength = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è°ƒç”¨å¡«å……å‡½æ•°</span></span><br><span class="line">    _init(message);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è°ƒç”¨å¾ªç¯åˆ†ç»„å‡½æ•°</span></span><br><span class="line">    _loop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Step-1-amp-2-ä¿¡æ¯å¡«å……ä¸è®°å½•ä¿¡æ¯é•¿åº¦"><a href="#Step-1-amp-2-ä¿¡æ¯å¡«å……ä¸è®°å½•ä¿¡æ¯é•¿åº¦" class="headerlink" title="Step 1&amp;2. ä¿¡æ¯å¡«å……ä¸è®°å½•ä¿¡æ¯é•¿åº¦"></a>Step 1&amp;2. ä¿¡æ¯å¡«å……ä¸è®°å½•ä¿¡æ¯é•¿åº¦</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> MD5::_init(<span class="keyword">const</span> <span class="built_in">string</span> input) &#123;</span><br><span class="line">    bit32 blocks = (((bit32)input.length() + <span class="number">8</span>) / <span class="number">64</span>) + <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    _strByte = <span class="keyword">new</span> bit32[blocks * <span class="number">16</span>];</span><br><span class="line">    _strLength = blocks * <span class="number">16</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* åˆå§‹åŒ– byte ä¸² */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; _strLength; i++) &#123;</span><br><span class="line">        _strByte[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; input.length(); i++) &#123;</span><br><span class="line">        _strByte[i &gt;&gt; <span class="number">2</span>] |= input[i] &lt;&lt; ((i % <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    _strByte[input.length() &gt;&gt; <span class="number">2</span>] |= (<span class="number">0x80</span> &lt;&lt; ((input.length() % <span class="number">4</span>) * <span class="number">8</span>));</span><br><span class="line">    </span><br><span class="line">    _strByte[blocks * <span class="number">16</span> - <span class="number">2</span>] = (bit32)input.size() * <span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Step-1-1"><a href="#Step-1-1" class="headerlink" title="Step 1.1"></a>Step 1.1</h4><p>æˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹MD5è¿›è¡Œåˆ†ç»„ã€‚MD5 ä»¥512ä½æ¥è¿›è¡Œåˆ†ç»„ã€‚æˆ‘ä»¬è¾“å…¥çš„<code>input</code>æ˜¯<code>char</code>ä¹Ÿå°±æ˜¯8ä½ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªåˆ†ç»„å°±ä¼šæœ‰ 512 $\div$ 8 = 64ä¸ª<code>char</code>å­—ç¬¦ã€‚</p>
<p>åˆå› ä¸ºæˆ‘ä»¬è¦åœ¨æœ€åç”¨64ä½æ¥è®°å½•ä¿¡æ¯é•¿åº¦ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯éœ€è¦ 64 $\div$ 8 = 8 ä¸ª<code>char</code>å­—ç¬¦ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åˆ†å—çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨ <code>input.length()</code> å¾—çŸ¥è¾“å…¥å¤šå°‘ä¸ª<code>char</code>å­—ç¬¦ï¼Œå†åŠ ä¸Šå›ºå®šçš„è®°å½•ä¿¡æ¯é•¿åº¦çš„8ä¸ªå­—ç¬¦ï¼Œå°±æ˜¯æˆ‘ä»¬ä¿¡æ¯çš„æ€»çš„é•¿åº¦ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºæˆ‘ä»¬éœ€è¦æœ‰å¤šå°‘ä¸ªåˆ†ç»„ã€‚</p>
<p>ğŸ‘‰ <code>bit32 blocks = (((bit32)input.length() + 8) / 64) + 1;</code></p>
<h4 id="Step-1-2"><a href="#Step-1-2" class="headerlink" title="Step 1.2"></a>Step 1.2</h4><p>æ¥ç€ï¼Œæˆ‘ä»¬è®¡ç®— <code>_strByte</code> ä¸ <code>_strLength</code>ã€‚</p>
<p>ä¸€ä¸ª <code>unsigned int</code> æœ‰32ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨16ä¸ª<code>int</code>å°±å¯ä»¥è¡¨è¾¾ 32 x 16 = 512 ä½ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªåˆ†ç»„ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦çš„å­˜å–æ•°æ®çš„ä½æ•°ï¼ŒåŒæ—¶åˆå§‹åŒ–æ‰€æœ‰ä½æ•°ä¸º0ã€‚</p>
<p>ğŸ‘‰ <code>_strByte = new bit32[blocks * 16];</code></p>
<p>åŒæ—¶æˆ‘ä»¬å¯ä»¥ç¡®è®¤å¡«å……åçš„å­—ç¬¦ä¸²çš„intçš„ä½æ•°</p>
<p>ğŸ‘‰ <code>_strLength = blocks * 16;</code></p>
<h4 id="Step-1-3"><a href="#Step-1-3" class="headerlink" title="Step 1.3"></a>Step 1.3</h4><p>ä¸€ä¸ª <code>char</code> 8ä½ï¼Œä¸€ä¸ª <code>unsigned int</code> 32ä½ï¼Œæ‰€ä»¥ä¸€ä¸ª <code>unsigned int</code> å¯ä»¥å­˜4ä¸ª <code>char</code> ã€‚</p>
<p>æˆ‘ä»¬å°†è¾“å…¥çš„å­—ç¬¦ï¼Œå­˜è¿›å»ã€‚é€šè¿‡</p>
<p>ğŸ‘‰ <code>_strByte[i &gt;&gt; 2] |= input[i] &lt;&lt; ((i % 4) * 8);</code></p>
<ul>
<li><p>æ¯ä¸ªå­—ç¬¦éƒ½æœ‰å¯¹åº”çš„ <strong>ASCII</strong> ç ã€‚</p>
</li>
<li><p><code>i &gt;&gt; 2</code> ä»£è¡¨çš„æ˜¯ i / 4ï¼Œ ä¹Ÿå°±æ˜¯æ‰¾åˆ°å­—ç¬¦æ‰€å¯¹åº”çš„ <code>_strByte</code> ä½ç½®ã€‚</p>
</li>
<li><p><code>(i % 4) * 8</code> å°±æ˜¯æ‰¾åˆ°è¿™ä¸ªå­—ç¬¦åœ¨ unsigned int ä¸­æ‰€å¯¹åº”çš„å­—èŠ‚ã€‚</p>
</li>
<li><p>| æ“ä½œå¯ä»¥ç†è§£ä¸ºæ±‚å’Œ æ¯”å¦‚ 3 | 4 = 7</p>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œè¾“å…¥ abc</p>
<p>é¦–å…ˆ i = 0, i &gt;&gt; 2 ç­‰äº0 æ‰€ä»¥æ˜¯ _strByte[0]ã€‚ç„¶åaå¯¹åº”çš„ASCIIä¸º97ï¼Œ((i % 4) * 8)ç­‰äº0<br>æ‰€ä»¥æ•´ä¸ªå¼å­ä¸º _strByte[0] |= 97 &lt;&lt; 0 å³ 97</p>
<p>æ¥ç€ i = 1, 1 &gt;&gt; 2 ç­‰äº0 æ‰€ä»¥æ˜¯ _strByte[0]ï¼Œå› ä¸ºä¸€ä¸ª uint å¯ä»¥å­˜ 4ä¸ªchar æ‰€ä»¥è¦ç­‰åˆ°ç¬¬äº”ä¸ªå­—ç¬¦è¾“å…¥çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ 5 &gt;&gt; 2 ç­‰äº 1 æ‰ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä½æ¥å­˜å‚¨å­—ç¬¦ã€‚åé¢((i % 4) * 8) ç­‰äº 8 ã€‚å› ä¸ºä¸€ä¸ªchar8ä½ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå­—ç¬¦å­˜è¿›æ¥çš„æ—¶å€™è¦å·¦ç§»å…«ä½ï¼Œå­˜åˆ°å®ƒåº”è¯¥åœ¨çš„åœ°æ–¹ã€‚<br>æ‰€ä»¥æ•´ä¸ªå¼å­ä¸º _strByte[0] |= 98 &lt;&lt; 8 å³ 25088 | 97 ç­‰äº 25158</p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œå°†è¾“å…¥å­˜åˆ° _strByte ä¸­ã€‚</p>
<h4 id="Step-1-4"><a href="#Step-1-4" class="headerlink" title="Step 1.4"></a>Step 1.4</h4><p>å¡«å…… 100000â€¦<br>åœ¨å­—ç¬¦éƒ½è½¬åŒ–å­˜å…¥ _strByte åæˆ‘ä»¬è¦åœ¨å‰©ä¸‹çš„ä½ç½®ç¬¬ä¸€ä¸ªå¡«å…… 1 å…¶ä»–å¡«å…… 0<br>åˆå› ä¸ºæˆ‘ä»¬åˆå§‹åŒ– _strByte ä¸ºå…¨0ï¼Œæ‰€ä»¥æˆ‘ä»¬åªç”¨ç¡®å®šå¡«å…… 1 åœ¨å“ªé‡Œå°±å¥½äº†ã€‚</p>
<p>ğŸ‘‰ <code>_strByte[input.length() &gt;&gt; 2] |= (0x80 &lt;&lt; ((input.length() % 4) * 8));</code></p>
<p>å…¶ä¸­0x80æ˜¯äºŒè¿›åˆ¶çš„10000000ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºåœ¨åŸæ¥å­—ç¬¦ä¸²çš„åé¢æ¥ä¸Šä¸€ä¸ª10000000<br>å…·ä½“å«ä¹‰å¯ä»¥å‚è€ƒ Step 1.3 ä¸­çš„è§£é‡Šã€‚</p>
<h4 id="Step-1-5"><a href="#Step-1-5" class="headerlink" title="Step 1.5"></a>Step 1.5</h4><p>è®°å½•å­—ç¬¦é•¿åº¦ã€‚é•¿åº¦æŒ‡ä½çš„é•¿åº¦ï¼Œæ‰€ä»¥è¦ä¹˜8ï¼ŒåŒæ—¶MD5ç®—æ³•ä½¿ç”¨çš„æ˜¯å°ç«¯åºï¼Œæ‰€ä»¥æ”¾åœ¨å€’æ•°ç¬¬äºŒä¸ªã€‚</p>
<p>ğŸ‘‰ <code>_strByte[blocks * 16 - 2] = (bit32)input.size() * 8;</code></p>
<h3 id="Step-3-å››è½®å¾ªç¯è¿ç®—"><a href="#Step-3-å››è½®å¾ªç¯è¿ç®—" class="headerlink" title="Step 3. å››è½®å¾ªç¯è¿ç®—"></a>Step 3. å››è½®å¾ªç¯è¿ç®—</h3><h4 id="å‰æœŸå‡†å¤‡-1"><a href="#å‰æœŸå‡†å¤‡-1" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h4><p>åˆ†ç»„å‡½æ•°ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> MD5::_loop() &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; _strLength / <span class="number">16</span>; i++) &#123;</span><br><span class="line">        bit32 group[<span class="number">16</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++) &#123;</span><br><span class="line">            group[j] = _strByte[i * <span class="number">16</span> + j];</span><br><span class="line">        &#125;</span><br><span class="line">        _transform(group);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>é¦–å…ˆæ˜¯æŒ‰ç…§512 bitsæ¥åˆ†ç»„ï¼Œå³16ä¸ªint</li>
<li>ç„¶åæ¯ä¸€åˆ†ç»„è¢«åˆ’åˆ†ä¸º16ä¸ª32ä½intçš„å­åˆ†ç»„</li>
</ol>
<p>ä¹‹åå°±å¯ä»¥è¿›è¡Œ _transform(group);</p>
<h4 id="ä¸»å˜æ¢å¾ªç¯"><a href="#ä¸»å˜æ¢å¾ªç¯" class="headerlink" title="ä¸»å˜æ¢å¾ªç¯"></a>ä¸»å˜æ¢å¾ªç¯</h4><p>MD5 ç®—æ³•å®šä¹‰</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> MD5::_transform(<span class="keyword">const</span> bit32 block[]) &#123;</span><br><span class="line">    bit32 a = _state[<span class="number">0</span>], b = _state[<span class="number">1</span>], c = _state[<span class="number">2</span>], d = _state[<span class="number">3</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Round 1 */</span></span><br><span class="line">    FF (a, b, c, d, block[<span class="number">0</span>], s11, <span class="number">0xd76aa478</span>);</span><br><span class="line">    FF (d, a, b, c, block[<span class="number">1</span>], s12, <span class="number">0xe8c7b756</span>);</span><br><span class="line">    FF (c, d, a, b, block[<span class="number">2</span>], s13, <span class="number">0x242070db</span>);</span><br><span class="line">    FF (b, c, d, a, block[<span class="number">3</span>], s14, <span class="number">0xc1bdceee</span>);</span><br><span class="line">    FF (a, b, c, d, block[<span class="number">4</span>], s11, <span class="number">0xf57c0faf</span>);</span><br><span class="line">    FF (d, a, b, c, block[<span class="number">5</span>], s12, <span class="number">0x4787c62a</span>);</span><br><span class="line">    FF (c, d, a, b, block[<span class="number">6</span>], s13, <span class="number">0xa8304613</span>);</span><br><span class="line">    FF (b, c, d, a, block[<span class="number">7</span>], s14, <span class="number">0xfd469501</span>);</span><br><span class="line">    FF (a, b, c, d, block[<span class="number">8</span>], s11, <span class="number">0x698098d8</span>);</span><br><span class="line">    FF (d, a, b, c, block[<span class="number">9</span>], s12, <span class="number">0x8b44f7af</span>);</span><br><span class="line">    FF (c, d, a, b, block[<span class="number">10</span>], s13, <span class="number">0xffff5bb1</span>);</span><br><span class="line">    FF (b, c, d, a, block[<span class="number">11</span>], s14, <span class="number">0x895cd7be</span>);</span><br><span class="line">    FF (a, b, c, d, block[<span class="number">12</span>], s11, <span class="number">0x6b901122</span>);</span><br><span class="line">    FF (d, a, b, c, block[<span class="number">13</span>], s12, <span class="number">0xfd987193</span>);</span><br><span class="line">    FF (c, d, a, b, block[<span class="number">14</span>], s13, <span class="number">0xa679438e</span>);</span><br><span class="line">    FF (b, c, d, a, block[<span class="number">15</span>], s14, <span class="number">0x49b40821</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Round 2 */</span></span><br><span class="line">    GG (a, b, c, d, block[ <span class="number">1</span>], s21, <span class="number">0xf61e2562</span>);</span><br><span class="line">    GG (d, a, b, c, block[ <span class="number">6</span>], s22, <span class="number">0xc040b340</span>);</span><br><span class="line">    GG (c, d, a, b, block[<span class="number">11</span>], s23, <span class="number">0x265e5a51</span>);</span><br><span class="line">    GG (b, c, d, a, block[ <span class="number">0</span>], s24, <span class="number">0xe9b6c7aa</span>);</span><br><span class="line">    GG (a, b, c, d, block[ <span class="number">5</span>], s21, <span class="number">0xd62f105d</span>);</span><br><span class="line">    GG (d, a, b, c, block[<span class="number">10</span>], s22,  <span class="number">0x2441453</span>);</span><br><span class="line">    GG (c, d, a, b, block[<span class="number">15</span>], s23, <span class="number">0xd8a1e681</span>);</span><br><span class="line">    GG (b, c, d, a, block[ <span class="number">4</span>], s24, <span class="number">0xe7d3fbc8</span>);</span><br><span class="line">    GG (a, b, c, d, block[ <span class="number">9</span>], s21, <span class="number">0x21e1cde6</span>);</span><br><span class="line">    GG (d, a, b, c, block[<span class="number">14</span>], s22, <span class="number">0xc33707d6</span>);</span><br><span class="line">    GG (c, d, a, b, block[ <span class="number">3</span>], s23, <span class="number">0xf4d50d87</span>);</span><br><span class="line">    GG (b, c, d, a, block[ <span class="number">8</span>], s24, <span class="number">0x455a14ed</span>);</span><br><span class="line">    GG (a, b, c, d, block[<span class="number">13</span>], s21, <span class="number">0xa9e3e905</span>);</span><br><span class="line">    GG (d, a, b, c, block[ <span class="number">2</span>], s22, <span class="number">0xfcefa3f8</span>);</span><br><span class="line">    GG (c, d, a, b, block[ <span class="number">7</span>], s23, <span class="number">0x676f02d9</span>);</span><br><span class="line">    GG (b, c, d, a, block[<span class="number">12</span>], s24, <span class="number">0x8d2a4c8a</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Round 3 */</span></span><br><span class="line">    HH (a, b, c, d, block[ <span class="number">5</span>], s31, <span class="number">0xfffa3942</span>);</span><br><span class="line">    HH (d, a, b, c, block[ <span class="number">8</span>], s32, <span class="number">0x8771f681</span>);</span><br><span class="line">    HH (c, d, a, b, block[<span class="number">11</span>], s33, <span class="number">0x6d9d6122</span>);</span><br><span class="line">    HH (b, c, d, a, block[<span class="number">14</span>], s34, <span class="number">0xfde5380c</span>);</span><br><span class="line">    HH (a, b, c, d, block[ <span class="number">1</span>], s31, <span class="number">0xa4beea44</span>);</span><br><span class="line">    HH (d, a, b, c, block[ <span class="number">4</span>], s32, <span class="number">0x4bdecfa9</span>);</span><br><span class="line">    HH (c, d, a, b, block[ <span class="number">7</span>], s33, <span class="number">0xf6bb4b60</span>);</span><br><span class="line">    HH (b, c, d, a, block[<span class="number">10</span>], s34, <span class="number">0xbebfbc70</span>);</span><br><span class="line">    HH (a, b, c, d, block[<span class="number">13</span>], s31, <span class="number">0x289b7ec6</span>);</span><br><span class="line">    HH (d, a, b, c, block[ <span class="number">0</span>], s32, <span class="number">0xeaa127fa</span>);</span><br><span class="line">    HH (c, d, a, b, block[ <span class="number">3</span>], s33, <span class="number">0xd4ef3085</span>);</span><br><span class="line">    HH (b, c, d, a, block[ <span class="number">6</span>], s34,  <span class="number">0x4881d05</span>);</span><br><span class="line">    HH (a, b, c, d, block[ <span class="number">9</span>], s31, <span class="number">0xd9d4d039</span>);</span><br><span class="line">    HH (d, a, b, c, block[<span class="number">12</span>], s32, <span class="number">0xe6db99e5</span>);</span><br><span class="line">    HH (c, d, a, b, block[<span class="number">15</span>], s33, <span class="number">0x1fa27cf8</span>);</span><br><span class="line">    HH (b, c, d, a, block[ <span class="number">2</span>], s34, <span class="number">0xc4ac5665</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* Round 4 */</span></span><br><span class="line">    II (a, b, c, d, block[ <span class="number">0</span>], s41, <span class="number">0xf4292244</span>);</span><br><span class="line">    II (d, a, b, c, block[ <span class="number">7</span>], s42, <span class="number">0x432aff97</span>);</span><br><span class="line">    II (c, d, a, b, block[<span class="number">14</span>], s43, <span class="number">0xab9423a7</span>);</span><br><span class="line">    II (b, c, d, a, block[ <span class="number">5</span>], s44, <span class="number">0xfc93a039</span>);</span><br><span class="line">    II (a, b, c, d, block[<span class="number">12</span>], s41, <span class="number">0x655b59c3</span>);</span><br><span class="line">    II (d, a, b, c, block[ <span class="number">3</span>], s42, <span class="number">0x8f0ccc92</span>);</span><br><span class="line">    II (c, d, a, b, block[<span class="number">10</span>], s43, <span class="number">0xffeff47d</span>);</span><br><span class="line">    II (b, c, d, a, block[ <span class="number">1</span>], s44, <span class="number">0x85845dd1</span>);</span><br><span class="line">    II (a, b, c, d, block[ <span class="number">8</span>], s41, <span class="number">0x6fa87e4f</span>);</span><br><span class="line">    II (d, a, b, c, block[<span class="number">15</span>], s42, <span class="number">0xfe2ce6e0</span>);</span><br><span class="line">    II (c, d, a, b, block[ <span class="number">6</span>], s43, <span class="number">0xa3014314</span>);</span><br><span class="line">    II (b, c, d, a, block[<span class="number">13</span>], s44, <span class="number">0x4e0811a1</span>);</span><br><span class="line">    II (a, b, c, d, block[ <span class="number">4</span>], s41, <span class="number">0xf7537e82</span>);</span><br><span class="line">    II (d, a, b, c, block[<span class="number">11</span>], s42, <span class="number">0xbd3af235</span>);</span><br><span class="line">    II (c, d, a, b, block[ <span class="number">2</span>], s43, <span class="number">0x2ad7d2bb</span>);</span><br><span class="line">    II (b, c, d, a, block[ <span class="number">9</span>], s44, <span class="number">0xeb86d391</span>);</span><br><span class="line">    </span><br><span class="line">    _state[<span class="number">0</span>] += a;</span><br><span class="line">    _state[<span class="number">1</span>] += b;</span><br><span class="line">    _state[<span class="number">2</span>] += c;</span><br><span class="line">    _state[<span class="number">3</span>] += d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Step-4-åˆå¹¶é“¾æ¥å˜é‡"><a href="#Step-4-åˆå¹¶é“¾æ¥å˜é‡" class="headerlink" title="Step 4. åˆå¹¶é“¾æ¥å˜é‡"></a>Step 4. åˆå¹¶é“¾æ¥å˜é‡</h3><p>å°±æ˜¯16è¿›åˆ¶çš„è½¬æ¢ï¼Œæ¯”è¾ƒç®€å•ã€‚</p>
<p>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼ŒMD5 æ˜¯å°ç«¯ç®—æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€åå¾—åˆ°çš„ç»“æœè¦å€’è¿‡æ¥ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> MD5::_toHex(<span class="keyword">const</span> bit32 number) &#123;</span><br><span class="line">    <span class="built_in">stringstream</span> ss;</span><br><span class="line">    ss &lt;&lt; hex &lt;&lt; number;</span><br><span class="line">    <span class="comment">// å°ç«¯ åè½¬</span></span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">""</span>;</span><br><span class="line">    result = ss.str().substr(<span class="number">6</span>, <span class="number">2</span>) + ss.str().substr(<span class="number">4</span>, <span class="number">2</span>) + ss.str().substr(<span class="number">2</span>, <span class="number">2</span>) + ss.str().substr(<span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Step-5-å¾—åˆ°ç­”æ¡ˆ"><a href="#Step-5-å¾—åˆ°ç­”æ¡ˆ" class="headerlink" title="Step 5. å¾—åˆ°ç­”æ¡ˆ"></a>Step 5. å¾—åˆ°ç­”æ¡ˆ</h3><p>å°†å¾—åˆ°æ–°çš„å››ä¸ªé“¾æ¥å˜é‡å€¼å˜æˆ16è¿›åˆ¶åŠ èµ·æ¥ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç»“æœå•¦ï¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> MD5::getResult() &#123;</span><br><span class="line">    _result += _toHex(_state[<span class="number">0</span>]);</span><br><span class="line">    _result += _toHex(_state[<span class="number">1</span>]);</span><br><span class="line">    _result += _toHex(_state[<span class="number">2</span>]);</span><br><span class="line">    _result += _toHex(_state[<span class="number">3</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> _result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">RUN TEST!</span><br><span class="line">TEST &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;----------</span><br><span class="line">MD5 ("") = d41d8cd9f08204be9800998ecf8427e</span><br><span class="line">MD5 ("a") = 0cc175b9c0f1b6a831c399e269772661</span><br><span class="line">MD5 ("abc") = 900150983cd24fb0d6963f7d28e17f72</span><br><span class="line">MD5 ("hello world") = 5eb63bbbe01eeed093cb22bb8f5acdc3</span><br><span class="line">MD5 ("abcdefghijklmnopqrstuvwxyz") = c3fcd3d76192e47dfb496cca67e13b</span><br><span class="line">MD5 ("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789") = d174ab98d277d9f5a5611c2c9f419d9f</span><br><span class="line">MD5 ("12345678901234567890123456789012345678901234567890123456789012345678901234567890") = 57edf4a22be3c955ac49da2e2107b67a</span><br><span class="line">Program ended with exit code: 0</span><br></pre></td></tr></table></figure>
<p></p></div><div class="share"><span>åˆ†äº«åˆ°</span>&nbsp;<span class="soc"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></span><span class="soc"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></span><span class="soc"><a href="http://twitter.com/home?status=http://zophyr.com/2018/12/01/hello-md5/%20è¿·æ¥¼%20MD5 ç®—æ³•çš„è®¾è®¡ä¸å®ç°" class="fa fa-twitter"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2018/12/04/how-to-own-a-pypi/" title="åˆ›å»ºå¹¶å‘å¸ƒä¸€ä¸ª python åŒ…"><i class="fa fa-angle-double-left"></i>&nbsp;ä¸Šä¸€ç¯‡: åˆ›å»ºå¹¶å‘å¸ƒä¸€ä¸ª python åŒ…</a></span><span> / </span><span class="next pagbuttons"><a role="navigation" href="/2018/11/24/huffman-coding/" title="å“ˆå¤«æ›¼ç¼–ç åŠåŠ¨æ€ç¼–ç åˆç›¸è¯†">ä¸‹ä¸€ç¯‡: å“ˆå¤«æ›¼ç¼–ç åŠåŠ¨æ€ç¼–ç åˆç›¸è¯†&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2019&nbsp;<a target="_blank" href="http://zophyr.com" rel="noopener noreferrer">Zephyr</a></p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>